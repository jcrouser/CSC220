for( i in 1:lengths(wifi[1])) {
if (wifi$value[i] == "paid" | wifi$value[i] == "free") {
wifi$value[i] = 1
} else if ( wifi$value[i] == "no") {
wifi$value[i] = 0
}
}
#average+quiet is 0, loud+very_loud is 1
noiselevel = attribute[attribute$name == "NoiseLevel",]
for( i in 1:lengths(noiselevel[1])) {
if( noiselevel$value[i] == "average" | noiselevel$value[i] == "quiet") {
noiselevel$value[i] = 0
} else {
noiselevel$value[i] = 1
}#end of else
}#end of forloop
alcohol = attribute[attribute$name == "Alcohol",]
for( i in 1: 44240 ){
if ( alcohol$value[i] == "none") {
alcohol$value[i] = 0
} else {
alcohol$value[i] = 1
}#end of else
}#end of for
attire = attribute[attribute$name == "RestaurantsAttire",]
#casual = 1, !casual = 0
for( i in 1:lengths(attire[1]) ) {
if ( attire$value[i] == "casual" ) {
attire$value[i] = 1
} else {
attire$value[i] = 0
}
}#end of forloop
priceRange = attribute[attribute$name == "RestaurantsPriceRange2",]
for(i in 1:lengths(priceRange[1])) {
#if price range is 1 or 2, then this is "low", which will be 0
if( priceRange$value[i] == 1 | priceRange$value[i] == 2) {
priceRange$value[i] = 0
}
#high price range, which will be 1
else if (priceRange$value[i] == 3 | priceRange$value[i] == 4) {
priceRange$value[i] = 1
}
}#end of i loop
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
attach(Boston)
library(dplyr)
set.seed(1)
train_Boston = Boston %>%
sample_frac(0.5)
test_Boston = Boston %>%
setdiff(train_Boston)
summary(Boston$crim)
train_crim = train_Boston %>%
select(crim) %>%
mutate(crim = cut(crim,
breaks = c(-Inf, 0.26, 3.61, Inf),
labels = c("low","average","high"))) %>%
.$crim
test_crim = test_Boston %>%
select(crim) %>%
mutate(crim = cut(crim,
breaks = c(-Inf, 0.25651, 3.61352, Inf),
labels = c("low","average","high"))) %>%
.$crim
train_Boston = train_Boston %>%
select(-crim)
test_Boston = test_Boston %>%
select(-crim)
library(class)
knn_pred = knn(train_Boston,
test_Boston,
train_crim,
k = 2)
table(knn_pred, test_crim)
mean(knn_pred == test_crim)
install.packages("rmarkdown", type = "source")
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
rmarkdown::render_site()
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC250/CSC250-website")
#render site.
rmarkdown::render_site()
knitr::opts_chunk$set(echo = TRUE)
set.seed(300)
x <- rnorm(100)
y <- 3*x^2 + 2 + rnorm(100)
samp <- sample(100, 50)
y[class] <- y[class] + 3
class <- rep(-1, 100)
class[samp] <- 1
train <- c(sample(samp, 50), sample(setdiff(1:100, samp), 50))
train.df <- data.frame(cl = as.factor(class[train]), y = y[train], x = x[train])
test.df <- data.frame(cl = as.factor(class[-train]), y = y[-train], x = x[-train])
svm.linear <- svm(cl~., data = train.df, kernel = "linear", cost = 10)
svm.pred.train <- predict(svm.linear, train.df)
knitr::opts_chunk$set(echo = TRUE)
library(e1071)
set.seed(300)
x <- rnorm(100)
y <- 3*x^2 + 2 + rnorm(100)
samp <- sample(100, 50)
y[class] <- y[class] + 3
class <- rep(-1, 100)
class[samp] <- 1
train <- c(sample(samp, 50), sample(setdiff(1:100, samp), 50))
train.df <- data.frame(cl = as.factor(class[train]), y = y[train], x = x[train])
test.df <- data.frame(cl = as.factor(class[-train]), y = y[-train], x = x[-train])
svm.linear <- svm(cl~., data = train.df, kernel = "linear", cost = 10)
plot(svm.linear,train.df)
set.seed(300)
x <- rnorm(100)
y <- 3*x^2 + 2 + rnorm(100)
samp <- sample(100, 50)
y[class] <- y[class] + 3
svm.pred.train <- predict(svm.linear, train.df)
svm.pred.test <- predict(svm.linear, test.df)
table(class[train], svm.pred.train)
svm.poly <- svm(cl~., data=train.df, kernel="polynomial", cost=10)
plot(svm.poly,train.df)
svm.pred.train <- predict(svm.poly, train.df)
svm.pred.test <- predict(svm.poly, test.df)
table(class[train], svm.pred.train)
table(class[-train], svm.pred.test)
svm.rad <- svm(cl~., data=train.df, kernel="radial", cost=10, gamma=1)
plot(svm.rad,train.df)
svm.pred.train <- predict(svm.rad, train.df)
svm.pred.test <- predict(svm.rad, test.df)
table(class[train], svm.pred.train)
table(class[-train], svm.pred.test)
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
attach(Boston)
set.seed(1)
fit <- lm(nox ~ poly(dis, 3), data = Boston)
summary(fit)
dislims <- range(Boston$dis)
dis.grid <- seq(from = dislims[1], to = dislims[2], by = 0.20)
preds <- predict(fit, list(dis = dis.grid))
plot(nox ~ dis, data = Boston, col = "pink")
lines(dis.grid, preds, col = "blue", lwd = 3)
rss <- rep(NA, 10)
for (i in 1:10) {
fit <- lm(nox ~ poly(dis, i), data = Boston)
rss[i] <- sum(fit$residuals^2)
}
plot(1:10, rss, xlab = "Degrees", ylab = "RSS", type = "l")
deltas <- rep(0, 10)
for (i in 1:10) {
poly_fit <- glm(nox ~ poly(dis, i), data = Boston)
predict_error[i] <- cv.glm(Boston, poly_fit, K = 10)
}
library(glmnet)
deltas <- rep(0, 10)
for (i in 1:10) {
poly_fit <- glm(nox ~ poly(dis, i), data = Boston)
predict_error[i] <- cv.glm(Boston, poly_fit, K = 10)
}
fit <- lm(nox ~ bs(dis, knots = c(4, 7, 13)), data = Boston)
library(boot)
deltas <- rep(0, 10)
for (i in 1:10) {
poly_fit <- glm(nox ~ poly(dis, i), data = Boston)
predict_error[i] <- cv.glm(Boston, poly_fit, K = 10)
}
library(boot)
predict_error <- rep(0, 10)
for (i in 1:10) {
poly_fit <- glm(nox ~ poly(dis, i), data = Boston)
predict_error[i] <- cv.glm(Boston, poly_fit, K = 10)
}
plot(1:10, predict_error, xlab = "Degree", ylab = "MSE Test", type = "l")
fit <- lm(nox ~ bs(dis, knots = c(4, 7, 13)), data = Boston)
library(splines)
fit <- lm(nox ~ bs(dis, knots = c(4, 7, 13)), data = Boston)
summary(fit)
predict <- predict(fit, list(dis = dis.grid))
plot(nox ~ dis, data = Boston, col = "purple")
lines(dis.grid, preds, col = "orange", lwd = 3)
rss <- rep(NA, 18)
for (i in 3:20) {
fit <- lm(nox ~ bs(dis, df = i), data = Boston)
rss[i] <- sum(fit$residuals^2)
}
plot(3:20, rss[-c(1, 2)], xlab = "Degrees of freedom", ylab = "RSS", type = "l")
cv <- rep(NA, 12)
for (i in 5:12) {
fit <- glm(nox ~ bs(dis, df = i), data = Boston)
cv[i] <- cv.glm(Boston, fit, K = 10)$delta[1]
}
plot(1:12, cv[-c(1, 2)], xlab = "The degree of freedom", ylab = "MSE Test", type = "l")
#Set our working directory.
#This helps avoid confusion if our working directory is
#not our site because of other projects we were
#working on at the time.
setwd("/Users/jcrouser/Google Drive/Teaching/Course Material/CSC220/CSC220-website")
#render site.
rmarkdown::render_site()
